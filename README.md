# Crop_LST
Biophysical effects of croplands on land surface temperature” by Chen et al (2024)

MATLAB version: R2021a

This repository includes a series of MATLAB scripts for analyzing the biophysical effects of croplands on land surface temperature (LST). To execute the workflow, ensure that paths and input data are properly configured.

Files Overview
File 1: A000_main_function.m
The main function file. Once paths and input data are configured, this function will produce the TRM results.

File 2: A001_lc_analysis_c61.m
This script extracts the mode land cover using 21 MODIS land cover maps, saving the output in a “.mat” file. Original MODIS MCD12C1 data in “.hdf” format is required.

File 3: A002_get_cropland_adjacent.m
Determines the search window size for each cropland pixel based on MODIS land cover data. Outputs the search window size in a “.mat” file. Requires the output from File 2, Landsat cropland fraction data, and DEM data.

File 4: A003_get_dominant_surrounding_biome.m
Identifies the dominant surrounding biome of each cropland pixel, with results saved in a “.mat” file.

File 5: A004_prepare_TRM_inputs_yearly_diurnal_MODIS_ERA.m
Prepares input data for TRM for all pixels. MODIS, ERA5-Land data, and all outputs from previous steps must be available prior to running this script.

File 6: A005_prepare_TRM_inputs_yearly_diurnal_MODIS_ERA_adj.m
Prepares input data for TRM for surrounding areas by averaging pixel-wise values generated by File 5. MODIS, ERA5-Land data, and all outputs from previous steps must be available prior to running this script.

File 7: A006_Get_TRM_outputs.m
Reads TRM inputs for cropland and surrounding areas, producing results for TRM-reconstructed LST, including contributions from each TRM attributing term.

File 8: TRM.m
The core TRM algorithm function.
